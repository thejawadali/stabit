generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model UserProfile {
  userId               String        @id @default(uuid())
  name                 String        @default("") @db.VarChar(255)
  email                String        @default("") @db.VarChar(255)
  avatarUrl            String        @default("") @db.VarChar(500)
  timezone             String        @default("UTC") @db.VarChar(50)
  language             String        @default("en") @db.VarChar(10)
  dateFormat           String        @default("MM/DD/YYYY") @db.VarChar(20)
  theme                Theme         @default(system)
  age                  Int           @default(0) @db.Int
  gender               Gender        @default(male)
  height               Int           @default(0) @db.Int
  isActive             Boolean       @default(true)
  personalGoals        String        @default("") @db.Text
  preferredTimeUnits   TimeUnit      @default(minutes)
  preferredCountUnits  CountUnit     @default(repetitions)
  defaultTrackingType  TrackingType  @default(duration)
  defaultGoalFrequency GoalFrequency @default(daily)
  autoSync             Boolean       @default(true)
  lastSyncTime         DateTime?     @db.Timestamp
  defaultDashboardView DashboardView @default(overview)
  showWelcomeMessage   Boolean       @default(true)
  
  notificationsEnabled Boolean       @default(false)

  // Notification Types
  enableReminders      Boolean       @default(true)
  enableMilestones     Boolean       @default(true)
  enableStreaks        Boolean       @default(true)
  
  // Reminder Settings
  defaultReminderTime  String?       @db.VarChar(20) @default("23:00 PM")
  reminderTone         ReminderTone  @default(gentle)
  smartReminders       Boolean       @default(true)
  
  // Delivery Channels
  inAppNotifications   Boolean       @default(true)
  emailNotifications   Boolean       @default(true)
  pushNotifications    Boolean       @default(true)
  
  // Quiet Hours
  quietHoursEnabled    Boolean       @default(false)
  quietHoursStart      String?       @db.VarChar(10)
  quietHoursEnd        String?       @db.VarChar(10)
  quietHoursDays       Json?         // Array of day strings: ["monday", "tuesday", ...]
  
  // Snooze Settings
  snoozeDuration       SnoozeDuration @default(oneHour)
  isSnoozed            Boolean       @default(false)
  snoozeUntil          DateTime?     @db.Timestamp

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


model Category {
  id          String   @id @default(uuid())
  name        String   @db.VarChar(100)
  description String?  @db.Text
  color       String   @default("#3B82F6") @db.VarChar(7) // Hex color code
  icon        String?  @db.VarChar(50) // Icon name or identifier
  isActive    Boolean  @default(true)
  userId      String   @db.VarChar(36) // User who created the category
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relationships
  habits      Habit[]

  @@map("categories")
}

model Habit {
  id                    String            @id @default(uuid())
  name                  String            @db.VarChar(255)
  description           String            @default("") @db.Text
  icon                  String            @default("ðŸŽ¯") @db.VarChar(50)
  recurrenceType        RecurrenceType    @default(daily)
  timeOfDay             String            @default("19:00") @db.VarChar(10)
  initialValue          Int          @default(0)
  difficultyRate        Int          @default(1)
  goalValue             Int          @default(0)
  goalMetric            String           @default("sessions") @db.VarChar(50)
  estimatedCompletionDate DateTime?       @db.Date
  status                HabitStatus       @default(active)
  isArchived            Boolean           @default(false)
  isActive              Boolean           @default(true)
  userId                String            @db.VarChar(36) // User who created the habit
  categoryId            String            @db.VarChar(36) // Category this habit belongs to
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt

  enableNotifications     Boolean           @default(true)
  reminderTimes          Json?

  // Relationships
  category              Category          @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@map("habits")
}


enum Theme {
  light
  dark
  system
}

enum Gender {
  male
  female
  other
}

enum TimeUnit {
  minutes
  hours
}

enum CountUnit {
  repetitions
  sessions
  times
  items
}

enum TrackingType {
  duration
  count
  both
}

enum GoalFrequency {
  daily
  weekly
  monthly
}

enum DashboardView {
  overview
  analytics
  calendar
  progress
}

enum ReminderTone {
  gentle
  motivational
  energetic
  calm
  custom
}

enum SnoozeDuration {
  fifteenMinutes
  oneHour
  twoHours
  fourHours
  eightHours
  twentyFourHours
}

enum RecurrenceType {
  daily
  weekly
  monthly
}

enum HabitStatus {
  active
  inactive
  completed
  paused
}
